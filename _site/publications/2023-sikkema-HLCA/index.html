<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Lisa Sikkema">
<meta name="author" content="Ciro Ramírez-Suástegui">
<meta name="author" content="Daniel C. Strobl">
<meta name="author" content="Tessa E. Gillett">
<meta name="author" content="Luke Zappia">
<meta name="author" content="Elo Madissoon">
<meta name="author" content="Nikolay S. Markov">
<meta name="author" content="Laure-Emmanuelle Zaragosi">
<meta name="author" content="Yuge Ji">
<meta name="author" content="Meshal Ansari">
<meta name="author" content="Marie-Jeanne Arguel">
<meta name="author" content="Leonie Apperloo">
<meta name="author" content="Martin Banchero">
<meta name="author" content="Christophe Bécavin">
<meta name="author" content="Marijn Berg">
<meta name="author" content="Evgeny Chichelnitskiy">
<meta name="author" content="Mei-i Chung">
<meta name="author" content="Antoine Collin">
<meta name="author" content="Aurore C. A. Gay">
<meta name="author" content="Janine Gote-Schniering">
<meta name="author" content="Baharak Hooshiar Kashani">
<meta name="author" content="Kemal Inecik">
<meta name="author" content="Manu Jain">
<meta name="author" content="Theodore S. Kapellos">
<meta name="author" content="Tessa M. Kole">
<meta name="author" content="Sylvie Leroy">
<meta name="author" content="Christoph H. Mayr">
<meta name="author" content="Amanda J. Oliver">
<meta name="author" content="Michael von Papen">
<meta name="author" content="Lance Peter">
<meta name="author" content="Chase J. Taylor">
<meta name="author" content="Thomas Walzthoeni">
<meta name="author" content="Chuan Xu">
<meta name="author" content="Linh T. Bui">
<meta name="author" content="Carlo De Donno">
<meta name="author" content="Leander Dony">
<meta name="author" content="Alen Faiz">
<meta name="author" content="Minzhe Guo">
<meta name="author" content="Austin J. Gutierrez">
<meta name="author" content="Lukas Heumos">
<meta name="author" content="Ni Huang">
<meta name="author" content="Ignacio L. Ibarra">
<meta name="author" content="Nathan D. Jackson">
<meta name="author" content="Preetish Kadur Lakshminarasimha Murthy">
<meta name="author" content="Mohammad Lotfollahi">
<meta name="author" content="Tracy Tabib">
<meta name="author" content="Carlos Talavera-López">
<meta name="author" content="Kyle J. Travaglini">
<meta name="author" content="Anna Wilbrey-Clark">
<meta name="author" content="Kaylee B. Worlock">
<meta name="author" content="Masahiro Yoshida">
<meta name="author" content="Lung Biological Network Consortium">
<meta name="author" content="Maarten van den Berge">
<meta name="author" content="Yohan Bossé">
<meta name="author" content="Tushar J. Desai">
<meta name="author" content="Oliver Eickelberg">
<meta name="author" content="Naftali Kaminski">
<meta name="author" content="Mark A. Krasnow">
<meta name="author" content="Robert Lafyatis">
<meta name="author" content="Marko Z. Nikolic">
<meta name="author" content="Joseph E. Powell">
<meta name="author" content="Jayaraj Rajagopal">
<meta name="author" content="Mauricio Rojas">
<meta name="author" content="Orit Rozenblatt-Rosen">
<meta name="author" content="Max A. Seibold">
<meta name="author" content="Dean Sheppard">
<meta name="author" content="Douglas P. Shepherd">
<meta name="author" content="Don D. Sin">
<meta name="author" content="Wim Timens">
<meta name="author" content="Alexander M. Tsankov">
<meta name="author" content="Jeffrey Whitsett">
<meta name="author" content="Yan Xu">
<meta name="author" content="Nicholas E. Banovich">
<meta name="author" content="Pascal Barbry">
<meta name="author" content="Thu Elizabeth Duong">
<meta name="author" content="Christine S. Falk">
<meta name="author" content="Kerstin B. Meyer">
<meta name="author" content="Jonathan A. Kropski">
<meta name="author" content="Dana Pe’er">
<meta name="author" content="Herbert B. Schiller">
<meta name="author" content="Purushothama Rao Tata">
<meta name="author" content="Joachim L. Schultze">
<meta name="author" content="Sara A. Teichmann">
<meta name="author" content="Alexander V. Misharin">
<meta name="author" content="Martijn C. Nawijn">
<meta name="author" content="Malte D. Luecken">
<meta name="author" content="Fabian J. Theis">
<meta name="dcterms.date" content="2023-08-06">

<title>An integrated cell atlas of the lung in health and disease – lazappi</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../icon.png" rel="icon" type="image/png">
<script src="../../site_libs/cookie-consent/cookie-consent.js"></script>
<link href="../../site_libs/cookie-consent/cookie-consent.css" rel="stylesheet">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark-b53751a350365c71b6c909e95f209ed1.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap-3825abfc899f2f50e99227930ca303e9.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark-83999eaec02f9411d69123612a24cdaa.min.css" rel="prefetch" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script async="" src="https://www.googletagmanager.com/gtag/js?id=G-20JH368VMR"></script>

<script type="text/plain" cookie-consent="tracking">

window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-20JH368VMR', { 'anonymize_ip': true});
</script>

<script type="text/javascript" charset="UTF-8">
document.addEventListener('DOMContentLoaded', function () {
cookieconsent.run({
  "notice_banner_type":"simple",
  "consent_type":"implied",
  "palette":"dark",
  "language":"en",
  "page_load_consent_levels":["strictly-necessary","functionality","tracking","targeting"],
  "notice_banner_reject_button_hide":false,
  "preferences_center_close_button_hide":false,
  "website_name":""
  ,
"language":"en"
  });
});
</script> 
  
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="">
<link href="https://fonts.googleapis.com/css2?family=Fira+Code&amp;family=Rubik&amp;display=swap" rel="stylesheet">


<meta property="og:title" content="An integrated cell atlas of the lung in health and disease – lazappi">
<meta property="og:description" content="Single-cell technologies have transformed our understanding of human tissues. Yet, studies typically capture only a limited number of donors and disagree on cell type definitions. Integrating many single-cell datasets can address these limitations of individual studies and capture the variability present in the population. Here we present the integrated Human Lung Cell Atlas (HLCA), combining 49 datasets of the human respiratory system into a single atlas spanning over 2.4 million cells from 486 individuals. The HLCA presents a consensus cell type re-annotation with matching marker genes, including annotations of rare and previously undescribed cell types. Leveraging the number and diversity of individuals in the HLCA, we identify gene modules that are associated with demographic covariates such as age, sex and body mass index, as well as gene modules changing expression along the proximal-to-distal axis of the bronchial tree. Mapping new data to the HLCA enables rapid data annotation and interpretation. Using the HLCA as a reference for the study of disease, we identify shared cell states across multiple lung diseases, including SPP1+ profibrotic monocyte-derived macrophages in COVID-19, pulmonary fibrosis and lung carcinoma. Overall, the HLCA serves as an example for the development and use of large-scale, cross-dataset organ atlases within the Human Cell Atlas.">
<meta property="og:site_name" content="lazappi">
<meta property="og:locale" content="en_AU">
<meta name="twitter:title" content="An integrated cell atlas of the lung in health and disease – lazappi">
<meta name="twitter:description" content="Single-cell technologies have transformed our understanding of human tissues. Yet, studies typically capture only a limited number of donors and disagree on cell type definitions. Integrating many single-cell datasets can address these limitations of individual studies and capture the variability present in the population. Here we present the integrated Human Lung Cell Atlas (HLCA), combining 49 datasets of the human respiratory system into a single atlas spanning over 2.4 million cells from 486 individuals. The HLCA presents a consensus cell type re-annotation with matching marker genes, including annotations of rare and previously undescribed cell types. Leveraging the number and diversity of individuals in the HLCA, we identify gene modules that are associated with demographic covariates such as age, sex and body mass index, as well as gene modules changing expression along the proximal-to-distal axis of the bronchial tree. Mapping new data to the HLCA enables rapid data annotation and interpretation. Using the HLCA as a reference for the study of disease, we identify shared cell states across multiple lung diseases, including SPP1+ profibrotic monocyte-derived macrophages in COVID-19, pulmonary fibrosis and lung carcinoma. Overall, the HLCA serves as an example for the development and use of large-scale, cross-dataset organ atlases within the Human Cell Atlas.">
<meta name="twitter:creator" content="@_lazappi_">
<meta name="twitter:site" content="@_lazappi_">
<meta name="twitter:card" content="summary">
<meta name="citation_title" content="An integrated cell atlas of the lung in health and disease">
<meta name="citation_abstract" content="Single-cell technologies have transformed our understanding of human tissues.
Yet, studies typically capture only a limited number of donors and disagree on cell type definitions.
Integrating many single-cell datasets can address these limitations of individual studies and capture the variability present in the population.
Here we present the integrated Human Lung Cell Atlas (HLCA), combining 49 datasets of the human respiratory system into a single atlas spanning over 2.4 million cells from 486 individuals.
The HLCA presents a consensus cell type re-annotation with matching marker genes, including annotations of rare and previously undescribed cell types.
Leveraging the number and diversity of individuals in the HLCA, we identify gene modules that are associated with demographic covariates such as age, sex and body mass index, as well as gene modules changing expression along the proximal-to-distal axis of the bronchial tree.
Mapping new data to the HLCA enables rapid data annotation and interpretation. Using the HLCA as a reference for the study of disease, we identify shared cell states across multiple lung diseases, including SPP1+ profibrotic monocyte-derived macrophages in COVID-19, pulmonary fibrosis and lung carcinoma.
Overall, the HLCA serves as an example for the development and use of large-scale, cross-dataset organ atlases within the Human Cell Atlas.
">
<meta name="citation_author" content="Lisa Sikkema">
<meta name="citation_author" content="Ciro Ramírez-Suástegui">
<meta name="citation_author" content="Daniel C. Strobl">
<meta name="citation_author" content="Tessa E. Gillett">
<meta name="citation_author" content="Luke Zappia">
<meta name="citation_author" content="Elo Madissoon">
<meta name="citation_author" content="Nikolay S. Markov">
<meta name="citation_author" content="Laure-Emmanuelle Zaragosi">
<meta name="citation_author" content="Yuge Ji">
<meta name="citation_author" content="Meshal Ansari">
<meta name="citation_author" content="Marie-Jeanne Arguel">
<meta name="citation_author" content="Leonie Apperloo">
<meta name="citation_author" content="Martin Banchero">
<meta name="citation_author" content="Christophe Bécavin">
<meta name="citation_author" content="Marijn Berg">
<meta name="citation_author" content="Evgeny Chichelnitskiy">
<meta name="citation_author" content="Mei-i Chung">
<meta name="citation_author" content="Antoine Collin">
<meta name="citation_author" content="Aurore C. A. Gay">
<meta name="citation_author" content="Janine Gote-Schniering">
<meta name="citation_author" content="Baharak Hooshiar Kashani">
<meta name="citation_author" content="Kemal Inecik">
<meta name="citation_author" content="Manu Jain">
<meta name="citation_author" content="Theodore S. Kapellos">
<meta name="citation_author" content="Tessa M. Kole">
<meta name="citation_author" content="Sylvie Leroy">
<meta name="citation_author" content="Christoph H. Mayr">
<meta name="citation_author" content="Amanda J. Oliver">
<meta name="citation_author" content="Michael von Papen">
<meta name="citation_author" content="Lance Peter">
<meta name="citation_author" content="Chase J. Taylor">
<meta name="citation_author" content="Thomas Walzthoeni">
<meta name="citation_author" content="Chuan Xu">
<meta name="citation_author" content="Linh T. Bui">
<meta name="citation_author" content="Carlo De Donno">
<meta name="citation_author" content="Leander Dony">
<meta name="citation_author" content="Alen Faiz">
<meta name="citation_author" content="Minzhe Guo">
<meta name="citation_author" content="Austin J. Gutierrez">
<meta name="citation_author" content="Lukas Heumos">
<meta name="citation_author" content="Ni Huang">
<meta name="citation_author" content="Ignacio L. Ibarra">
<meta name="citation_author" content="Nathan D. Jackson">
<meta name="citation_author" content="Preetish Kadur Lakshminarasimha Murthy">
<meta name="citation_author" content="Mohammad Lotfollahi">
<meta name="citation_author" content="Tracy Tabib">
<meta name="citation_author" content="Carlos Talavera-López">
<meta name="citation_author" content="Kyle J. Travaglini">
<meta name="citation_author" content="Anna Wilbrey-Clark">
<meta name="citation_author" content="Kaylee B. Worlock">
<meta name="citation_author" content="Masahiro Yoshida">
<meta name="citation_author" content="Lung Biological Network Consortium">
<meta name="citation_author" content="Maarten van den Berge">
<meta name="citation_author" content="Yohan Bossé">
<meta name="citation_author" content="Tushar J. Desai">
<meta name="citation_author" content="Oliver Eickelberg">
<meta name="citation_author" content="Naftali Kaminski">
<meta name="citation_author" content="Mark A. Krasnow">
<meta name="citation_author" content="Robert Lafyatis">
<meta name="citation_author" content="Marko Z. Nikolic">
<meta name="citation_author" content="Joseph E. Powell">
<meta name="citation_author" content="Jayaraj Rajagopal">
<meta name="citation_author" content="Mauricio Rojas">
<meta name="citation_author" content="Orit Rozenblatt-Rosen">
<meta name="citation_author" content="Max A. Seibold">
<meta name="citation_author" content="Dean Sheppard">
<meta name="citation_author" content="Douglas P. Shepherd">
<meta name="citation_author" content="Don D. Sin">
<meta name="citation_author" content="Wim Timens">
<meta name="citation_author" content="Alexander M. Tsankov">
<meta name="citation_author" content="Jeffrey Whitsett">
<meta name="citation_author" content="Yan Xu">
<meta name="citation_author" content="Nicholas E. Banovich">
<meta name="citation_author" content="Pascal Barbry">
<meta name="citation_author" content="Thu Elizabeth Duong">
<meta name="citation_author" content="Christine S. Falk">
<meta name="citation_author" content="Kerstin B. Meyer">
<meta name="citation_author" content="Jonathan A. Kropski">
<meta name="citation_author" content="Dana Pe’er">
<meta name="citation_author" content="Herbert B. Schiller">
<meta name="citation_author" content="Purushothama Rao Tata">
<meta name="citation_author" content="Joachim L. Schultze">
<meta name="citation_author" content="Sara A. Teichmann">
<meta name="citation_author" content="Alexander V. Misharin">
<meta name="citation_author" content="Martijn C. Nawijn">
<meta name="citation_author" content="Malte D. Luecken">
<meta name="citation_author" content="Fabian J. Theis">
<meta name="citation_publication_date" content="2023-08-06">
<meta name="citation_cover_date" content="2023-08-06">
<meta name="citation_year" content="2023">
<meta name="citation_online_date" content="2023-08-06">
<meta name="citation_fulltext_html_url" content="https://doi.org/10.1038/s41591-023-02327-2">
<meta name="citation_issue" content="6">
<meta name="citation_doi" content="10.1038/s41591-023-02327-2">
<meta name="citation_issn" content="1078-8956">
<meta name="citation_pmid" content="37291214">
<meta name="citation_volume" content="29">
<meta name="citation_language" content="en">
<meta name="citation_firstpage" content="1563">
<meta name="citation_lastpage" content="1577">
<meta name="citation_journal_title" content="Nature Medicine">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">lazappi</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../posts/index.html"> 
<span class="menu-text">Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../projects/index.html"> 
<span class="menu-text">Projects</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../talks/index.html"> 
<span class="menu-text">Talks</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../publications/index.html"> 
<span class="menu-text">Publications</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/lazappi"> <i class="bi bi-github" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="../../posts/index.xml"> <i class="bi bi-rss" role="img">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">An integrated cell atlas of the lung in health and disease</h1>
  <div class="quarto-categories">
    <div class="quarto-category">single-cell</div>
    <div class="quarto-category">rna-seq</div>
    <div class="quarto-category">lung</div>
    <div class="quarto-category">atlas</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
              <p>
                              Lisa Sikkema
                                      </p>
              <p>
                              Ciro Ramírez-Suástegui
                                      </p>
              <p>
                              Daniel C. Strobl
                                      </p>
              <p>
                              Tessa E. Gillett
                                      </p>
              <p>
                                </p><p style="color: #eb008d"><strong>
                    Luke Zappia
                      </strong></p>
                                      <p></p>
              <p>
                              Elo Madissoon
                                      </p>
              <p>
                              Nikolay S. Markov
                                      </p>
              <p>
                              Laure-Emmanuelle Zaragosi
                                      </p>
              <p>
                              Yuge Ji
                                      </p>
              <p>
                              Meshal Ansari
                                      </p>
              <p>
                              Marie-Jeanne Arguel
                                      </p>
              <p>
                              Leonie Apperloo
                                      </p>
              <p>
                              Martin Banchero
                                      </p>
              <p>
                              Christophe Bécavin
                                      </p>
              <p>
                              Marijn Berg
                                      </p>
              <p>
                              Evgeny Chichelnitskiy
                                      </p>
              <p>
                              Mei-i Chung
                                      </p>
              <p>
                              Antoine Collin
                                      </p>
              <p>
                              Aurore C. A. Gay
                                      </p>
              <p>
                              Janine Gote-Schniering
                                      </p>
              <p>
                              Baharak Hooshiar Kashani
                                      </p>
              <p>
                              Kemal Inecik
                                      </p>
              <p>
                              Manu Jain
                                      </p>
              <p>
                              Theodore S. Kapellos
                                      </p>
              <p>
                              Tessa M. Kole
                                      </p>
              <p>
                              Sylvie Leroy
                                      </p>
              <p>
                              Christoph H. Mayr
                                      </p>
              <p>
                              Amanda J. Oliver
                                      </p>
              <p>
                              Michael von Papen
                                      </p>
              <p>
                              Lance Peter
                                      </p>
              <p>
                              Chase J. Taylor
                                      </p>
              <p>
                              Thomas Walzthoeni
                                      </p>
              <p>
                              Chuan Xu
                                      </p>
              <p>
                              Linh T. Bui
                                      </p>
              <p>
                              Carlo De Donno
                                      </p>
              <p>
                              Leander Dony
                                      </p>
              <p>
                              Alen Faiz
                                      </p>
              <p>
                              Minzhe Guo
                                      </p>
              <p>
                              Austin J. Gutierrez
                                      </p>
              <p>
                              Lukas Heumos
                                      </p>
              <p>
                              Ni Huang
                                      </p>
              <p>
                              Ignacio L. Ibarra
                                      </p>
              <p>
                              Nathan D. Jackson
                                      </p>
              <p>
                              Preetish Kadur Lakshminarasimha Murthy
                                      </p>
              <p>
                              Mohammad Lotfollahi
                                      </p>
              <p>
                              Tracy Tabib
                                      </p>
              <p>
                              Carlos Talavera-López
                                      </p>
              <p>
                              Kyle J. Travaglini
                                      </p>
              <p>
                              Anna Wilbrey-Clark
                                      </p>
              <p>
                              Kaylee B. Worlock
                                      </p>
              <p>
                              Masahiro Yoshida
                                      </p>
              <p>
                              Lung Biological Network Consortium
                                      </p>
              <p>
                              Maarten van den Berge
                                      </p>
              <p>
                              Yohan Bossé
                                      </p>
              <p>
                              Tushar J. Desai
                                      </p>
              <p>
                              Oliver Eickelberg
                                      </p>
              <p>
                              Naftali Kaminski
                                      </p>
              <p>
                              Mark A. Krasnow
                                      </p>
              <p>
                              Robert Lafyatis
                                      </p>
              <p>
                              Marko Z. Nikolic
                                      </p>
              <p>
                              Joseph E. Powell
                                      </p>
              <p>
                              Jayaraj Rajagopal
                                      </p>
              <p>
                              Mauricio Rojas
                                      </p>
              <p>
                              Orit Rozenblatt-Rosen
                                      </p>
              <p>
                              Max A. Seibold
                                      </p>
              <p>
                              Dean Sheppard
                                      </p>
              <p>
                              Douglas P. Shepherd
                                      </p>
              <p>
                              Don D. Sin
                                      </p>
              <p>
                              Wim Timens
                                      </p>
              <p>
                              Alexander M. Tsankov
                                      </p>
              <p>
                              Jeffrey Whitsett
                                      </p>
              <p>
                              Yan Xu
                                      </p>
              <p>
                              Nicholas E. Banovich
                                      </p>
              <p>
                              Pascal Barbry
                                      </p>
              <p>
                              Thu Elizabeth Duong
                                      </p>
              <p>
                              Christine S. Falk
                                      </p>
              <p>
                              Kerstin B. Meyer
                                      </p>
              <p>
                              Jonathan A. Kropski
                                      </p>
              <p>
                              Dana Pe’er
                                      </p>
              <p>
                              Herbert B. Schiller
                                      </p>
              <p>
                              Purushothama Rao Tata
                                      </p>
              <p>
                              Joachim L. Schultze
                                      </p>
              <p>
                              Sara A. Teichmann
                                      </p>
              <p>
                              Alexander V. Misharin
                                      </p>
              <p>
                              Martijn C. Nawijn
                                      </p>
              <p>
                              Malte D. Luecken
                                      </p>
              <p>
                              Fabian J. Theis
                                      </p>
          </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Date</div>
    <div class="quarto-title-meta-contents">
      <p class="date">August 6, 2023</p>
    </div>
  </div>
  
  
  
    <div>
    <div class="quarto-title-meta-heading">Links</div>
    <div class="quarto-title-meta-contents">
                          <a type="button" class="btn btn-outline-primary" href="https://github.com/LungCellAtlas/HLCA_reproducibility">Code</a>
                    <a type="button" class="btn btn-outline-primary" href="https://doi.org/10.1038/s41591-023-02327-2">DOI</a>
                    <a type="button" class="btn btn-outline-primary" href="https://www.nature.com/articles/s41591-023-02327-2.pdf">PDF</a>
                    <a type="button" class="btn btn-outline-primary" href="https://doi.org/10.1101/2022.03.10.483747">Preprint</a>
                            </div>
  </div>
  
    <div>
    <div class="quarto-title-meta-heading">Citation stats</div>
    <div class="quarto-title-meta-contents">
      <div class="scite-badge" data-doi="10.1038/s41591-023-02327-2" data-layout="vertical" data-show-zero="true" data-small="false" data-show-labels="true" data-tally-show="true">
      </div>
    </div>
  </div>
  <script async="" type="application/javascript" src="https://cdn.scite.ai/badge/scite-badge-latest.min.js">
  </script>
  
</div>


<div>
  <div class="abstract">
    <div class="abstract-title">Abstract</div>
    <p>Single-cell technologies have transformed our understanding of human tissues. Yet, studies typically capture only a limited number of donors and disagree on cell type definitions. Integrating many single-cell datasets can address these limitations of individual studies and capture the variability present in the population. Here we present the integrated Human Lung Cell Atlas (HLCA), combining 49 datasets of the human respiratory system into a single atlas spanning over 2.4 million cells from 486 individuals. The HLCA presents a consensus cell type re-annotation with matching marker genes, including annotations of rare and previously undescribed cell types. Leveraging the number and diversity of individuals in the HLCA, we identify gene modules that are associated with demographic covariates such as age, sex and body mass index, as well as gene modules changing expression along the proximal-to-distal axis of the bronchial tree. Mapping new data to the HLCA enables rapid data annotation and interpretation. Using the HLCA as a reference for the study of disease, we identify shared cell states across multiple lung diseases, including SPP1+ profibrotic monocyte-derived macrophages in COVID-19, pulmonary fibrosis and lung carcinoma. Overall, the HLCA serves as an example for the development and use of large-scale, cross-dataset organ atlases within the Human Cell Atlas.</p>
  </div>
</div>



</header>





<div id="quarto-appendix" class="default"><section class="quarto-appendix-contents" id="quarto-citation"><h2 class="anchored quarto-appendix-heading">Citation</h2><div><div class="quarto-appendix-secondary-label">BibTeX citation:</div><pre class="sourceCode code-with-copy quarto-appendix-bibtex"><code class="sourceCode bibtex">@article{sikkema2023,
  author = {Sikkema, Lisa and Ramírez-Suástegui, Ciro and C. Strobl,
    Daniel and E. Gillett, Tessa and Zappia, Luke and Madissoon, Elo and
    S. Markov, Nikolay and Zaragosi, Laure-Emmanuelle and Ji, Yuge and
    Ansari, Meshal and Arguel, Marie-Jeanne and Apperloo, Leonie and
    Banchero, Martin and Bécavin, Christophe and Berg, Marijn and
    Chichelnitskiy, Evgeny and Chung, Mei-i and Collin, Antoine and C.
    A. Gay, Aurore and Gote-Schniering, Janine and Hooshiar Kashani,
    Baharak and Inecik, Kemal and Jain, Manu and S. Kapellos, Theodore
    and M. Kole, Tessa and Leroy, Sylvie and H. Mayr, Christoph and J.
    Oliver, Amanda and von Papen, Michael and Peter, Lance and J.
    Taylor, Chase and Walzthoeni, Thomas and Xu, Chuan and T. Bui, Linh
    and De Donno, Carlo and Dony, Leander and Faiz, Alen and Guo, Minzhe
    and J. Gutierrez, Austin and Heumos, Lukas and Huang, Ni and L.
    Ibarra, Ignacio and D. Jackson, Nathan and Kadur Lakshminarasimha
    Murthy, Preetish and Lotfollahi, Mohammad and Tabib, Tracy and
    Talavera-López, Carlos and J. Travaglini, Kyle and Wilbrey-Clark,
    Anna and B. Worlock, Kaylee and Yoshida, Masahiro and Biological
    Network Consortium, Lung and van den Berge, Maarten and Bossé, Yohan
    and J. Desai, Tushar and Eickelberg, Oliver and Kaminski, Naftali
    and A. Krasnow, Mark and Lafyatis, Robert and Z. Nikolic, Marko and
    E. Powell, Joseph and Rajagopal, Jayaraj and Rojas, Mauricio and
    Rozenblatt-Rosen, Orit and A. Seibold, Max and Sheppard, Dean and P.
    Shepherd, Douglas and D. Sin, Don and Timens, Wim and M. Tsankov,
    Alexander and Whitsett, Jeffrey and Xu, Yan and E. Banovich,
    Nicholas and Barbry, Pascal and Elizabeth Duong, Thu and S. Falk,
    Christine and B. Meyer, Kerstin and A. Kropski, Jonathan and Pe’er,
    Dana and B. Schiller, Herbert and Rao Tata, Purushothama and L.
    Schultze, Joachim and A. Teichmann, Sara and V. Misharin, Alexander
    and C. Nawijn, Martijn and D. Luecken, Malte and J. Theis, Fabian},
  title = {An Integrated Cell Atlas of the Lung in Health and Disease},
  journal = {Nature Medicine},
  volume = {29},
  number = {6},
  pages = {1563-1577},
  date = {2023-08-06},
  url = {https://doi.org/10.1038/s41591-023-02327-2},
  doi = {10.1038/s41591-023-02327-2},
  issn = {1078-8956},
  langid = {en},
  abstract = {Single-cell technologies have transformed our
    understanding of human tissues. Yet, studies typically capture only
    a limited number of donors and disagree on cell type definitions.
    Integrating many single-cell datasets can address these limitations
    of individual studies and capture the variability present in the
    population. Here we present the integrated Human Lung Cell Atlas
    (HLCA), combining 49 datasets of the human respiratory system into a
    single atlas spanning over 2.4 million cells from 486 individuals.
    The HLCA presents a consensus cell type re-annotation with matching
    marker genes, including annotations of rare and previously
    undescribed cell types. Leveraging the number and diversity of
    individuals in the HLCA, we identify gene modules that are
    associated with demographic covariates such as age, sex and body
    mass index, as well as gene modules changing expression along the
    proximal-to-distal axis of the bronchial tree. Mapping new data to
    the HLCA enables rapid data annotation and interpretation. Using the
    HLCA as a reference for the study of disease, we identify shared
    cell states across multiple lung diseases, including SPP1+
    profibrotic monocyte-derived macrophages in COVID-19, pulmonary
    fibrosis and lung carcinoma. Overall, the HLCA serves as an example
    for the development and use of large-scale, cross-dataset organ
    atlases within the Human Cell Atlas.}
}
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre><div class="quarto-appendix-secondary-label">For attribution, please cite this work as:</div><div id="ref-sikkema2023" class="csl-entry quarto-appendix-citeas" role="listitem">
<div class="">Sikkema, L., Ramírez-Suástegui, C., C. Strobl,
D., E. Gillett, T., Zappia, L., Madissoon, E., S. Markov, N., Zaragosi,
L.-E., Ji, Y., Ansari, M., Arguel, M.-J., Apperloo, L., Banchero, M.,
Bécavin, C., Berg, M., Chichelnitskiy, E., Chung, M., Collin, A., C. A.
Gay, A., Gote-Schniering, J., Hooshiar Kashani, B., Inecik, K., Jain,
M., S. Kapellos, T., M. Kole, T., Leroy, S., H. Mayr, C., J. Oliver, A.,
von Papen, M., Peter, L., J. Taylor, C., Walzthoeni, T., Xu, C., T. Bui,
L., De Donno, C., Dony, L., Faiz, A., Guo, M., J. Gutierrez, A., Heumos,
L., Huang, N., L. Ibarra, I., D. Jackson, N., Kadur Lakshminarasimha
Murthy, P., Lotfollahi, M., Tabib, T., Talavera-López, C., J.
Travaglini, K., Wilbrey-Clark, A., B. Worlock, K., Yoshida, M.,
Biological Network Consortium, L., van den Berge, M., Bossé, Y., J.
Desai, T., Eickelberg, O., Kaminski, N., A. Krasnow, M., Lafyatis, R.,
Z. Nikolic, M., E. Powell, J., Rajagopal, J., Rojas, M.,
Rozenblatt-Rosen, O., A. Seibold, M., Sheppard, D., P. Shepherd, D., D.
Sin, D., Timens, W., M. Tsankov, A., Whitsett, J., Xu, Y., E. Banovich,
N., Barbry, P., Elizabeth Duong, T., S. Falk, C., B. Meyer, K., A.
Kropski, J., Pe’er, D., B. Schiller, H., Rao Tata, P., L. Schultze, J.,
A. Teichmann, S., V. Misharin, A., C. Nawijn, M., D. Luecken, M. &amp;
J. Theis, F. <a href="https://doi.org/10.1038/s41591-023-02327-2">An
integrated cell atlas of the lung in health and disease</a>. <em>Nature
Medicine</em> <strong>29,</strong> 1563–1577 (2023).</div>
</div></div></section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/lazappi\.id\.au");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
 © 2016-2025, Luke Zappia
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">

<div class="cookie-consent-footer"><a href="#" id="open_preferences_center">Cookie Preferences</a></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../license.html">
<p>License</p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>